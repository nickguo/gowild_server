<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8">
      <title>GoWild! Banking</title>
      <script src="//code.jquery.com/jquery-1.10.2.js"></script>
    <%= stylesheet_link_tag "style.css" %>
</head>

<body>
    <div id="header">
        <% if user_signed_in? %>
            <%= link_to('Logout', destroy_user_session_path) %>
        <% else %>
            <%= link_to('Sign up', new_user_registration_path) %>
            <br>
            <%= link_to('Login', new_user_session_path) %>
        <% end %>
    </div>

<%= yield %>

<table>
<% if user_signed_in? %>
    <thead>
    <h1>Account Balances</h1>
    <% if current_user.accounts.count <= 0 %>
        <th>No accounts found, please contact your local teller!</th>
    <% else %>
        <tr>
        <th style="padding:0 15px 0 15px">Account Type</th>
        <th style="padding:0 15px 0 15px">Account Number</th>
        <th style="padding:0 15px 0 15px">Balance</th>
        <th colspan="2"></th>
        </tr>
    <% end %>
    </thead>
<% end %>

<tbody>
    <% if user_signed_in? %>
        <% if current_user.accounts.count != 0 %>
            <% current_user.accounts.each do |acc| %>
                <%= form_for acc do |f| %>
                    <tr>
                    <td align="center"><%= acc.account_type %></td>
                    <td align="center"><%= acc.account_number %></td>
                    <td align="center"><%= acc.balance %></td>
                    <td align="center"><%= text_field_tag 'amount', '0'%></td>
                    <%= f.hidden_field 'id' %>
                    <td><%= f.submit 'Deposit' %></td>
                    <td><button type='button' Class=<%=acc.id%>>Show transactions</button></td>
                    </tr>

                    <% if acc.transactions.count != 0%>
                        <tr align="center">
                        <td><div Class="hidden <%=acc.id%>" style="font-weight:bold">Transaction Type</div></td>
                        <td><div Class="hidden <%=acc.id%>" style="font-weight:bold">By</div></td>
                        <td><div Class="hidden <%=acc.id%>" style="font-weight:bold">Amount</div></td>
                        <td><div Class="hidden <%=acc.id%>" style="font-weight:bold">Date</div></td>
                        </tr>
                    <% else %>
                        <tr align="center">
                        <td><div Class="hidden <%=acc.id%>" style="font-weight:bold">No transactions</div></td>
                        </tr>

                    <% end %>

                    <% acc.transactions.each do |transaction| %>
                    <tr align="center">
                        <td><div Class="hidden <%=acc.id%>"><%= transaction.transaction_type%></div></td>
                        <td><div Class="hidden <%=acc.id%>"><%= transaction.by%></div></td>
                        <td><div Class="hidden <%=acc.id%>"><%= transaction.amount%></div></td>
                        <td><div Class="hidden <%=acc.id%>"><%= transaction.created_at%></div></td>
                    </tr>
                    <% end %>
                    <script>
                    $( "button."+<%=acc.id%> ).click(function() {
                        $( "div."+<%=acc.id%> ).toggle( "slow" );
                        var el = $(this);
                        el.text() == "Show transactions" ? el.text("Hide transactions") :
                                                           el.text("Show transactions");
                    });
                    </script>

                    <tr class="strikeout">
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    </tr>

                <% end %>
            <% end %>
        <% end %>

    <% else %>
        <td>Not signed in </td>
    <% end %>
</tbody>
</table>
<br>


</body>


</html>
